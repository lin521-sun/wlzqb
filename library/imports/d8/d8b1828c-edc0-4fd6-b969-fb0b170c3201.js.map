{"version":3,"sources":["assets\\script\\Index.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Created by carolsail\r\n\r\nimport { ENUM_RESOURCE_TYPE, ENUM_UI_TYPE } from \"./Enum\";\r\nimport AudioManager from \"./manager/AudioManager\";\r\nimport DataManager from './manager/DataManager';\r\nimport ResourceManager from \"./manager/ResourceManager\";\r\nimport SdkManager from \"./manager/SdkManager\";\r\nimport { StaticInstance } from \"./StaticInstance\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\ndeclare let tt: any;\r\ndeclare let wx: any;\r\n@ccclass\r\nexport default class Index extends cc.Component {\r\n\r\n    @property\r\n    collisionManagerDebug: boolean = false;\r\n    @property(cc.Sprite)\r\n    loadfill: cc.Sprite = null\r\n    @property(cc.Node)\r\n    loadball: cc.Node = null\r\n    @property(cc.Node)\r\n    jdt: cc.Node = null\r\n    /**\r\n        * 加载场景时的初始化操作。\r\n        * 此函数负责调用第三方登录SDK进行登录操作，加载资源，恢复游戏状态，初始化碰撞检测系统，\r\n        * 以及加载和初始化微信SDK的相关功能。\r\n        */\r\n    protected async onLoad() {\r\n        if (window[\"tt\"]) {\r\n            tt.login({\r\n                force: true,\r\n                success(res) {\r\n                    console.log(`login 调用成功${res.code} ${res.anonymousCode}`);\r\n                },\r\n                fail(res) {\r\n                    console.log(`login 调用失败`);\r\n                },\r\n            });\r\n        }\r\n        DataManager.instance.loadingRate = 0\r\n        this.loadball.x = -278;\r\n        // 加载resource资源\r\n        await ResourceManager.instance.loadRes(ENUM_RESOURCE_TYPE.AUDIO)\r\n        await ResourceManager.instance.loadRes(ENUM_RESOURCE_TYPE.FLAG)\r\n        // 读档\r\n        DataManager.instance.restore()\r\n        // 播放音乐\r\n        AudioManager.instance.playMusic()\r\n        // 碰撞系统\r\n        const colManager = cc.director.getCollisionManager();\r\n        colManager.enabled = true;\r\n        if (this.collisionManagerDebug) {\r\n            colManager.enabledDebugDraw = true;\r\n        }\r\n        // 初始化微信sdk\r\n        SdkManager.instance.videoAdLoad()\r\n        // SdkManager.instance.getRank()\r\n        SdkManager.instance.gameSharePassive()\r\n        if (window[\"wx\"]) {\r\n            const loadTask = wx.loadSubpackage({\r\n                name: 'Bundle1', // name 可以填 name 或者 root\r\n                success: function (res) {\r\n                    // 分包加载成功后通过 success 回调\r\n                },\r\n                fail: function (res) {\r\n                    // 分包加载失败通过 fail 回调\r\n                }\r\n            })\r\n\r\n            loadTask.onProgressUpdate(res => {\r\n                console.log('下载进度', res.progress)\r\n                console.log('已经下载的数据长度', res.totalBytesWritten)\r\n                console.log('预期需要下载的数据总长度', res.totalBytesExpectedToWrite)\r\n            })\r\n        }\r\n\r\n    }\r\n    once: boolean = true;\r\n    /**\r\n   * 根据数据管理器的加载进度更新加载界面的显示。\r\n   * 此方法主要用于在游戏加载过程中，动态更新加载条的填充进度和加载球的位置。\r\n   * 当加载进度达到100%时，切换界面从加载界面到主菜单界面。\r\n   * \r\n   * @param dt 时间间隔，通常代表每帧的时间长度，用于更新动画效果。\r\n   */\r\n    protected update(dt: number): void {\r\n        // console.log(DataManager.instance.loadingRate)\r\n        if (this.loadfill && this.once) {\r\n            this.loadfill.fillRange = DataManager.instance.loadingRate\r\n            this.loadball.x = -278 + this.loadfill.fillRange * 588;\r\n            this.jdt.width = this.loadfill.fillRange * 608;\r\n            if (DataManager.instance.loadingRate >= 1) {\r\n                this.once = false;\r\n                // menu已加载完毕\r\n                // 展示ui\r\n                StaticInstance.uiManager.toggle(ENUM_UI_TYPE.LOADING, false)\r\n                StaticInstance.uiManager.toggle(ENUM_UI_TYPE.MENU, true, () => {\r\n                    DataManager.instance.loadingRate = 1\r\n                })\r\n            }\r\n        }\r\n    }\r\n}\r\n"]}