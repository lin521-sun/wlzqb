{"version":3,"sources":["assets\\script\\layer\\LevelLayer.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Created by carolsail\r\n\r\nimport { ENUM_AUDIO_CLIP, ENUM_GAME_EVENT, ENUM_UI_TYPE } from \"../Enum\";\r\nimport { StaticInstance } from './../StaticInstance';\r\nimport AudioManager from \"../manager/AudioManager\";\r\nimport BaseLayer from \"./Baselayer\";\r\nimport ResourceManager from \"../manager/ResourceManager\";\r\nimport DataManager from \"../manager/DataManager\";\r\nimport { Levels } from \"../Levels\";\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class LevelLayer extends BaseLayer {\r\n\r\n    @property(cc.Node)\r\n    levelContent: cc.Node = null\r\n    @property(cc.Prefab)\r\n    levelItemPrefab: cc.Prefab = null\r\n\r\n    onEnable(){\r\n        this.onRendor()\r\n    }\r\n\r\n    onCloseClick(){\r\n        AudioManager.instance.playSound(ENUM_AUDIO_CLIP.CLICK)\r\n        StaticInstance.uiManager.toggle(ENUM_UI_TYPE.LEVEL, false)\r\n    }\r\n\r\n    async onRendor(){\r\n        if(!(this.levelContent && this.levelItemPrefab)) return\r\n        this.levelContent.removeAllChildren()\r\n        for(let i = 0; i < Levels.length; i++){\r\n            const data = Levels[i]['info']\r\n            const levelItem: cc.Node = cc.instantiate(this.levelItemPrefab)\r\n            const level = i + 1\r\n            const flag = await ResourceManager.instance.getFlag(data['icon'])\r\n            levelItem.getChildByName('flag').getComponent(cc.Sprite).spriteFrame = flag\r\n            levelItem.getChildByName('team').getComponent(cc.Label).string = `${data['team']}`\r\n            levelItem.getChildByName('intro').getComponent(cc.Label).string = `${data['intro']}`\r\n            levelItem.parent = this.levelContent\r\n            const button = levelItem.getComponent(cc.Button)\r\n            if(level > DataManager.instance.maxLevel){\r\n                levelItem.getChildByName('lock').active = true\r\n                button.enabled = false\r\n            }else{\r\n                levelItem.getChildByName('lock').active = false\r\n                // button添加事件\r\n                const event = new cc.Component.EventHandler()\r\n                event.target = this.node\r\n                event.component = 'LevelLayer'\r\n                event.handler = 'onLevelItemClick'\r\n                event.customEventData = `${level}`\r\n                button.clickEvents.push(event)\r\n            }\r\n        }\r\n    }\r\n\r\n    onLevelItemClick(e: any, level: string){\r\n        AudioManager.instance.playSound(ENUM_AUDIO_CLIP.CLICK)\r\n        const currentLevel: number = parseInt(level)\r\n        if(currentLevel <= DataManager.instance.maxLevel){\r\n            DataManager.instance.level = currentLevel\r\n            StaticInstance.uiManager.toggle(ENUM_UI_TYPE.MENU, false)\r\n            StaticInstance.uiManager.toggle(ENUM_UI_TYPE.LEVEL, false)\r\n            StaticInstance.uiManager.toggle(ENUM_UI_TYPE.GAME)\r\n        }\r\n    }\r\n}\r\n"]}